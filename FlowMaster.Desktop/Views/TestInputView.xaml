<UserControl x:Class="FlowMaster.Desktop.Views.TestInputView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1000">
    
    <UserControl.Resources>
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#002c5f"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#666"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,5,0"/>
        </Style>
        
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
    </UserControl.Resources>
    
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>  <!-- Header -->
                <RowDefinition Height="Auto"/>  <!-- Info Grid -->
                <RowDefinition Height="*"/>     <!-- Checklist -->
                <RowDefinition Height="Auto"/>  <!-- Description (BA2 only) -->
                <RowDefinition Height="Auto"/>  <!-- Comment -->
                <RowDefinition Height="Auto"/>  <!-- Buttons -->
            </Grid.RowDefinitions>
            
            <!-- Header -->
            <Border Grid.Row="0" Background="#002c5f" CornerRadius="8,8,0,0" Padding="15">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="ðŸ“‹" FontSize="20"/>
                        <TextBox Text="{Binding Title, UpdateSourceTrigger=PropertyChanged}" 
                                 FontSize="18" FontWeight="Bold" Foreground="White"
                                 Background="Transparent" BorderThickness="0"
                                 Margin="0,5,0,0"/>
                    </StackPanel>
                    
                    <Border Grid.Column="1" Background="{Binding StatusColor}" 
                            CornerRadius="4" Padding="12,6" VerticalAlignment="Center">
                        <TextBlock Text="{Binding StatusText}" Foreground="White" FontWeight="SemiBold"/>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Info Grid -->
            <Border Grid.Row="1" Background="White" Padding="15" BorderBrush="#ddd" BorderThickness="1,0,1,1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- ê²°ìž¬ ì •ë³´ -->
                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <TextBlock Text="ê²°ìž¬ ì •ë³´" Style="{StaticResource SectionHeader}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="ìž‘ì„±ìž:" Style="{StaticResource FieldLabel}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding WriterName}" VerticalAlignment="Center"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="ê²°ìž¬ìž:" Style="{StaticResource FieldLabel}"/>
                            <ComboBox Grid.Row="1" Grid.Column="1" 
                                      ItemsSource="{Binding AvailableApprovers}"
                                      SelectedItem="{Binding SelectedApprover}"
                                      DisplayMemberPath="Name"/>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="ê²°ìž¬ì¼:" Style="{StaticResource FieldLabel}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding ApprovalDate}" VerticalAlignment="Center"/>
                        </Grid>
                    </StackPanel>
                    
                    <!-- ë¬¸ì„œ ì •ë³´ -->
                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                        <TextBlock Text="ë¬¸ì„œ ì •ë³´" Style="{StaticResource SectionHeader}"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                                <RowDefinition Height="30"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="ìœ í˜•:" Style="{StaticResource FieldLabel}"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding TableType}" 
                                       FontWeight="Bold" Foreground="#002c5f" VerticalAlignment="Center"/>
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="ë°œì „ê¸°:" Style="{StaticResource FieldLabel}"/>
                            <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding GenType, UpdateSourceTrigger=PropertyChanged}"/>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="ì¸ì í„°:" Style="{StaticResource FieldLabel}"/>
                            <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding InjType, UpdateSourceTrigger=PropertyChanged}"/>
                        </Grid>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Checklist DataGrid -->
            <Border Grid.Row="2" Background="White" Margin="0,10,0,0" 
                    BorderBrush="#ddd" BorderThickness="1" CornerRadius="8">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <Border Grid.Row="0" Background="#f8f8f8" Padding="10" CornerRadius="8,8,0,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì²´í¬ë¦¬ìŠ¤íŠ¸" Style="{StaticResource SectionHeader}" Margin="0"/>
                            <TextBlock Text="{Binding ChecklistItemCount, StringFormat=' - {0}í•­ëª©'}" 
                                       Foreground="#888" VerticalAlignment="Center" Margin="10,0,0,0"/>
                        </StackPanel>
                    </Border>
                    
                    <DataGrid Grid.Row="1" ItemsSource="{Binding ChecklistItems}"
                              AutoGenerateColumns="False" CanUserAddRows="False"
                              HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                              BorderThickness="0" MinHeight="200" MaxHeight="400">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="No." Binding="{Binding RowNo}" Width="60" IsReadOnly="True"/>
                            <DataGridTextColumn Header="í™•ì¸í•­ëª©" Binding="{Binding CheckItem}" Width="*" IsReadOnly="True"/>
                            <DataGridTextColumn Header="ì‚°ì¶œë¬¼" Binding="{Binding OutputContent}" Width="150"/>
                            <DataGridComboBoxColumn Header="í‰ê°€" Width="80">
                                <DataGridComboBoxColumn.ItemsSource>
                                    <x:Array Type="sys:String" xmlns:sys="clr-namespace:System;assembly=mscorlib">
                                        <sys:String>+</sys:String>
                                        <sys:String>(+)</sys:String>
                                        <sys:String>(-)</sys:String>
                                        <sys:String>-</sys:String>
                                        <sys:String>nb</sys:String>
                                    </x:Array>
                                </DataGridComboBoxColumn.ItemsSource>
                                <DataGridComboBoxColumn.SelectedItemBinding>
                                    <Binding Path="EvaluationCode"/>
                                </DataGridComboBoxColumn.SelectedItemBinding>
                            </DataGridComboBoxColumn>
                            <DataGridTextColumn Header="ë¹„ê³ " Binding="{Binding Remarks}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>
            
            <!-- Description (BA2 only) -->
            <Border Grid.Row="3" Background="White" Margin="0,10,0,0" Padding="15"
                    BorderBrush="#ddd" BorderThickness="1" CornerRadius="8"
                    Visibility="{Binding ShowDescription}">
                <StackPanel>
                    <TextBlock Text="Description / ë©”ëª¨" Style="{StaticResource SectionHeader}"/>
                    <TextBox Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}"
                             AcceptsReturn="True" TextWrapping="Wrap"
                             MinHeight="100" MaxHeight="200"
                             VerticalScrollBarVisibility="Auto"/>
                </StackPanel>
            </Border>
            
            <!-- Approver Comment -->
            <Border Grid.Row="4" Background="#fff8e8" Margin="0,10,0,0" Padding="15"
                    BorderBrush="#ffe0a0" BorderThickness="1" CornerRadius="8"
                    Visibility="{Binding ShowApproverComment}">
                <StackPanel>
                    <TextBlock Text="ê²°ìž¬ ì½”ë©˜íŠ¸" Style="{StaticResource SectionHeader}"/>
                    <TextBlock Text="{Binding ApproverComment}" TextWrapping="Wrap"/>
                </StackPanel>
            </Border>
            
            <!-- Action Buttons -->
            <Border Grid.Row="5" Background="#f8f8f8" Margin="0,10,0,0" Padding="15"
                    CornerRadius="8">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="ëª©ë¡ìœ¼ë¡œ" Command="{Binding GoBackCommand}" 
                            Style="{StaticResource ActionButton}" Background="#e4dcd3"/>
                    <Button Content="ì €ìž¥" Command="{Binding SaveCommand}" 
                            Style="{StaticResource ActionButton}" Background="#4CAF50" Foreground="White"/>
                    <Button Content="ê²°ìž¬ ìƒì‹ " Command="{Binding SubmitCommand}" 
                            Style="{StaticResource ActionButton}" Background="#002c5f" Foreground="White"
                            Visibility="{Binding CanSubmit}"/>
                    <Button Content="ìŠ¹ì¸" Command="{Binding ApproveCommand}" 
                            Style="{StaticResource ActionButton}" Background="#2196F3" Foreground="White"
                            Visibility="{Binding CanApprove}"/>
                    <Button Content="ë°˜ë ¤" Command="{Binding RejectCommand}" 
                            Style="{StaticResource ActionButton}" Background="#f44336" Foreground="White"
                            Visibility="{Binding CanApprove}"/>
                </StackPanel>
            </Border>
        </Grid>
    </ScrollViewer>
</UserControl>
