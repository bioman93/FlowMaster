<UserControl x:Class="FlowMaster.Desktop.Views.WriteView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:vm="clr-namespace:FlowMaster.Desktop.ViewModels"
             d:DataContext="{d:DesignInstance Type=vm:WriteViewModel}"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800">
    <UserControl.Resources>
        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="Margin" Value="0,0,0,5"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#333"/>
        </Style>
    </UserControl.Resources>
    
    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Title -->
            <RowDefinition Height="Auto"/> <!-- Header inputs -->
            <RowDefinition Height="*"/>    <!-- Grid -->
            <RowDefinition Height="Auto"/> <!-- Buttons -->
        </Grid.RowDefinitions>

        <!-- 1. Page Title -->
        <TextBlock Grid.Row="0" Text="결재 문서 작성 (New Application)" 
                   FontSize="22" Foreground="#002c5f" Margin="0,0,0,20" />

        <!-- 2. Form Inputs -->
        <StackPanel Grid.Row="1">
            <TextBlock Text="문서 제목 (Title)"/>
            <TextBox Text="{Binding Title}" />
            
            <TextBlock Text="작성자 (Writer)"/>
            <TextBlock Text="{Binding Writer.Name}" Margin="0,0,0,15" Foreground="Gray"/>
            
            <TextBlock Text="결재자 선택 (Approver)"/>
            <ComboBox ItemsSource="{Binding ApproverCandidates}" 
                      SelectedItem="{Binding SelectedApprover}"
                      DisplayMemberPath="Name"
                      Padding="5" Margin="0,0,0,20"/>
        </StackPanel>

        <!-- 3. Test Results Grid -->
        <DockPanel Grid.Row="2">
            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,5">
                <TextBlock Text="테스트 결과 상세 (Test Results)" VerticalAlignment="Center"/>
                <Button Content="+ 행 추가" Command="{Binding AddTestResultCommand}" 
                        Margin="10,0,0,0" Padding="5,2" Background="#e4dcd3" BorderThickness="0"/>
            </StackPanel>
            
            <DataGrid ItemsSource="{Binding TestResults}" AutoGenerateColumns="False" 
                      CanUserAddRows="False" Background="White" BorderBrush="#ccc" BorderThickness="1">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="프로젝트명" Binding="{Binding ProjectName}" Width="150"/>
                    <DataGridTextColumn Header="버전" Binding="{Binding Version}" Width="80"/>
                    <DataGridTextColumn Header="테스트명" Binding="{Binding TestCaseName}" Width="150"/>
                    <DataGridCheckBoxColumn Header="성공여부" Binding="{Binding IsPass}" Width="80"/>
                    <DataGridTextColumn Header="실패사유" Binding="{Binding FailureReason}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>
        </DockPanel>

        <!-- 4. Action Buttons -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="결재 상신 (Submit)" Command="{Binding SubmitCommand}" 
                    Background="#002c5f" Foreground="White" Padding="20,10" FontWeight="Bold" BorderThickness="0">
                <Button.Resources>
                    <Style TargetType="Border">
                        <Setter Property="CornerRadius" Value="4"/>
                    </Style>
                </Button.Resources>
            </Button>
        </StackPanel>
    </Grid>
</UserControl>
